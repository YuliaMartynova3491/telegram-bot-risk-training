# Telegram-бот для обучения сотрудников рискам непрерывности деятельности

## Описание проекта

Это телеграм-бот, предназначенный для обучения сотрудников Банка рискам нарушения непрерывности деятельности. Бот реализует модульную систему обучения с последовательным прохождением уроков и тем.

## Основные возможности

- Многопользовательский доступ (одновременное обучение нескольких сотрудников)
- Модульная архитектура проекта
- Генерация вопросов с помощью базы знаний
- Адаптивное обучение
- Геймификация процесса обучения
- Последовательное прохождение уроков и тем
- Сохранение прогресса обучения
- Интерактивные сценарии для практического применения знаний
- Визуализация прогресса обучения

## Структура обучения

1. Обучение разделено на темы:
   - Риск нарушения непрерывности
   - Оценка критичности процессов
   - Оценка риска нарушения непрерывности

2. Каждая тема содержит несколько уроков

3. После каждого урока пользователь отвечает на 3 вопроса

4. Для перехода к следующему уроку необходимо правильно ответить на 80% вопросов

## Установка и запуск

### Важно: Настройка секретов и конфиденциальной информации

⚠️ **Перед началом работы необходимо создать файл `.env` с секретными данными!**

1. Скопируйте и переименуйте файл шаблона конфигурации:
```bash
cp app/config.py.template app/config.py
```

2. Создайте файл `.env` в корневом каталоге проекта:
```bash
touch .env
```

3. Заполните файл `.env` следующим содержимым:
```
# Токен Telegram бота (получите через BotFather в Telegram)
TELEGRAM_TOKEN=your_telegram_token_here

# URL базы данных
DATABASE_URL=sqlite:///risk_training.db

# URL LLM модели
LLM_MODEL_PATH=http://localhost:1234/v1
```

4. **Никогда не коммитьте файлы с секретами в репозиторий!** Файлы `.env` и `app/config.py` добавлены в `.gitignore`.

5. **Перед каждым коммитом проверяйте, что вы не добавляете секретные данные**:
```bash
git diff --staged
```

### Подготовка окружения

1. Клонировать репозиторий:
```bash
git clone https://github.com/yourusername/telegram-bot-risk-training.git
cd telegram-bot-risk-training
```

2. Создать виртуальное окружение и установить зависимости:
```bash
python -m venv venv
source venv/bin/activate  # Для Linux/macOS
venv\Scripts\activate     # Для Windows
pip install -r requirements.txt
```

3. Запустить LM Studio для работы с локальной моделью:
   - Скачайте и установите [LM Studio](https://lmstudio.ai/)
   - Запустите LM Studio
   - Выберите и загрузите модель (рекомендуется Mistral-7B или Llama-2)
   - Запустите модель (Settings → Server → Start Server)

4. Запустить бота:
```bash
python -m app.main
```

## Технологии

- Python
- python-telegram-bot
- SQLAlchemy
- LM Studio (для локальной модели)

## Структура проекта

```
telegram-bot-risk-training/
├── app/
│   ├── __init__.py
│   ├── main.py                  # Точка входа в приложение
│   ├── config.py                # Конфигурация проекта (не коммитить!)
│   ├── config.py.template       # Шаблон конфигурации (безопасный для коммита)
│   ├── database/                # Модуль для работы с базой данных
│   ├── bot/                     # Модуль для работы с Telegram API
│   ├── knowledge/               # Модуль для работы с базой знаний
│   └── learning/                # Модуль для работы с обучением
├── tests/                       # Тесты
├── .env                         # Файл с переменными окружения (не коммитить!)
├── .gitignore                   # Файл с исключениями для Git
├── requirements.txt             # Зависимости проекта
└── README.md                    # Документация по проекту
```

## Правила безопасности

1. **Никогда не храните токены и API ключи в исходном коде**
   - Используйте файл `.env` для хранения секретов
   - Убедитесь, что файл `.env` добавлен в `.gitignore`

2. **Перед каждым коммитом проверяйте, что вы не добавляете конфиденциальные данные**
   - Используйте команду `git diff --staged` для просмотра изменений
   - Убедитесь, что конфиденциальные данные не попадают в коммит

3. **Всегда используйте шаблоны для конфигурационных файлов**
   - Создавайте файлы *.template с заглушками вместо реальных данных
   - В реальных конфигурационных файлах используйте переменные окружения

4. **Регулярно проверяйте токены и ключи на компрометацию**
   - Если возникают подозрения о компрометации, немедленно меняйте токены
   - Периодически обновляйте токены, даже если нет признаков компрометации

## Устранение неполадок

1. **Бот не отвечает**
   - Проверьте, что токен бота указан правильно в файле `.env`
   - Убедитесь, что скрипт запущен и работает без ошибок
   - Проверьте подключение к интернету

2. **Ошибки с LM Studio**
   - Убедитесь, что LM Studio запущен и сервер активен
   - Проверьте, что модель загружена и работает
   - Убедитесь, что адрес в `.env` соответствует настройкам LM Studio

3. **Проблемы с зависимостями**
   - Попробуйте обновить pip: `pip install --upgrade pip`
   - Установите зависимости по одной:
     ```bash
     pip install python-telegram-bot==20.8
     pip install langchain==0.1.8
     # и т.д.
     ```

4. **Перезагрузка базы данных**
   - Если необходимо сбросить базу данных, просто удалите файл `risk_training.db`
   - При следующем запуске бота база данных будет создана заново